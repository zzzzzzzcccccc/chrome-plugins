var tabManagerHttpIntercept=function(){"use strict";var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function e(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var n="object"==typeof t&&t&&t.Object===Object&&t,o="object"==typeof self&&self&&self.Object===Object&&self,r=(n||o||Function("return this")()).Symbol;var a=function(t,e){for(var n=-1,o=null==t?0:t.length,r=Array(o);++n<o;)r[n]=e(t[n],n,t);return r},i=Array.isArray,u=r,s=Object.prototype,c=s.hasOwnProperty,f=s.toString,d=u?u.toStringTag:void 0;var l=function(t){var e=c.call(t,d),n=t[d];try{t[d]=void 0;var o=!0}catch(t){}var r=f.call(t);return o&&(e?t[d]=n:delete t[d]),r},p=Object.prototype.toString;var v=l,T=function(t){return p.call(t)},_=r?r.toStringTag:void 0;var E=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":_&&_ in Object(t)?v(t):T(t)},h=function(t){return null!=t&&"object"==typeof t};var w=a,y=i,O=function(t){return"symbol"==typeof t||h(t)&&"[object Symbol]"==E(t)},g=r?r.prototype:void 0,L=g?g.toString:void 0;var R=function t(e){if("string"==typeof e)return e;if(y(e))return w(e,t)+"";if(O(e))return L?L.call(e):"";var n=e+"";return"0"==n&&1/e==-Infinity?"-0":n},b=R;var N=function(t){return null==t?"":b(t)},H=/[\\^$.*+?()[\]{}|]/g,P=RegExp(H.source);var m,I,S,B,C=e((function(t){return(t=N(t))&&P.test(t)?t.replace(H,"\\$&"):t}));!function(t){t.SET="set",t.APPEND="append"}(m||(m={})),function(t){t.MODIFY="modify"}(I||(I={})),function(t){t.BACKGROUND="BACKGROUND",t.CONTENT_SCRIPT="CONTENT_SCRIPT"}(S||(S={})),function(t){t.UPDATE_HTTP_BLOCKING_RULES="UPDATE_HTTP_BLOCKING_RULES",t.REMOVE_HTTP_BLOCKING_RULES="REMOVE_HTTP_BLOCKING_RULES",t.UPDATE_HTTP_BLOCKING_ENABLED="UPDATE_HTTP_BLOCKING_ENABLED",t.GET_HTTP_BLOCKING_ENABLED="GET_HTTP_BLOCKING_ENABLED"}(B||(B={}));var A,D,M,j,U,G,K,x,q,X=(D=[window.XMLHttpRequest.prototype.open,window.XMLHttpRequest.prototype.send,window.fetch],M=D[0],j=D[1],U=D[2],G=[],K=function(t){var e=t.url,n=t.method,o=(new Date).toISOString();console.info("[".concat(o,"]%c[Tab Manager][http-intercept][").concat(n,"]:").concat(e instanceof URL?e.href:e),"color: #1890ff;")},x=function(t){var e=t.method,n=void 0===e?"get":e,o=t.url;if(null==G?void 0:G.length)return G.find((function(t){return t.condition.requestMethods.indexOf(n.toLocaleLowerCase())>-1&&function(t,e){var n=e instanceof URL?e.href:e;return t===n||t.indexOf(n)>-1||new RegExp(C(t)).test(n)}(t.condition.regexFilter,o)}))},q=function(t){var e=t.data.___CHROME_TAB_MANAGER___;if(e&&e.to===S.CONTENT_SCRIPT){var n=e.method,o=e.data;switch(n){case B.UPDATE_HTTP_BLOCKING_RULES:!function(t){G=t}(o);break;case B.REMOVE_HTTP_BLOCKING_RULES:G=[]}}},A=["status","statusText","response","responseText","readyState"],window.XMLHttpRequest.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=t[0],o=t[1],r=x({method:n,url:o});r&&(this.__httpBlockingItem=r,K({method:n,url:o})),M.apply(this,t)},window.XMLHttpRequest.prototype.send=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var o=this.__httpBlockingItem;o?(A.forEach((function(e){return Object.defineProperty(t,e,{writable:!0})})),setTimeout((function(){t.status=200,t.statusText="OK",t.readyState=XMLHttpRequest.DONE,t.response=o.action.responseData,t.responseText=o.action.responseData,t.getAllResponseHeaders=function(){return o.action.responseHeaders.map((function(t){var e=t.header,n=t.value;return"".concat(e,": ").concat(n)})).join("\n")},t.getResponseHeader=function(t){var e;return(null===(e=o.action.responseHeaders.find((function(e){return e.header===t})))||void 0===e?void 0:e.value)||null},t.dispatchEvent(new Event("readystatechange")),t.dispatchEvent(new Event("loadend")),delete t.__httpBlockingItem}),0)):j.apply(this,e)},window.fetch=function(t,e){var n="get",o="";"string"==typeof t&&(o=t),t instanceof Request&&(n=t.method,o=t.url),e&&(n=e.method||n);var r=x({method:n,url:o});return r?(K({method:n,url:o}),new Promise((function(t){setTimeout((function(){t(new Response(r.action.responseData,{status:200,statusText:"OK",headers:r.action.responseHeaders.reduce((function(t,e){var n=e.header,o=e.value;return t.set(n,o),t}),new Headers)}))}),0)}))):U(t,e)},window.addEventListener("message",q),{unIntercept:function(){window.XMLHttpRequest.prototype.open=M,window.XMLHttpRequest.prototype.send=j,window.fetch=U,window.removeEventListener("message",q)}});return X}();
//# sourceMappingURL=http-intercept.js.map
